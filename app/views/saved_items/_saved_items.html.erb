<%- if grouped_elements.any? %>
  <%= form_with url: export_to_csv_saved_items_path, remote: true do -%>
    <% if range_errors.any? -%>
      <div class="govuk-error-summary" aria-labelledby="error-summary-title" role="alert" tabindex="-1" data-module="govuk-error-summary">
        <h2 class="govuk-error-summary__title" id="error-summary-title">
          Can't export the information
        </h2>
        <div class="govuk-error-summary__body">
          <ul class="govuk-list govuk-error-summary__list">
            <% range_errors.each do |error| -%>
              <li><a href="#"><%= error %></a></li>
            <%- end %>
          </ul>
        </div>
      </div>
    <%- end %>

    <%= render partial: 'export_bar' %>

    <%- grouped_elements.each do |dataset, group| %>
      <table class="govuk-table govuk-!-font-size-16" data-dataset-id="<%= dataset.id %>">
        <caption class="govuk-table__caption govuk-heading-m">
          <%= link_to dataset.tab_name.upcase, dataset_url(dataset) %>
        </caption>
        <%= render partial: 'saved_items/saved_items_thead', locals: { id: dataset.id } %>
        <tbody class="govuk-table__body">
          <%= render partial: 'saved_items/element', collection: group, as: :element, locals: { dataset: dataset } %>
          <tr class="govuk-table__row">
            <th data-label="Remove this dataset" class="govuk-table__header govuk-table__cell--numeric" scope="row" colspan="7">
              <a href="remove-dataset-<%= dataset.id %>" class="dataset-remove" id="<%= dataset.id %>">
                Remove this dataset
              </a>
            </th>
          </tr>
        </tbody>
      </table>
    <%- end %>

    <%= render partial: 'export_bar' %>
  <%- end %>
<%- end %>

<div class="govuk-inset-text no-elements <%= grouped_elements.any? ? 'hidden' : ''%>">
  <%= t('saved_data.my_list.no_elements') %>
</div>
